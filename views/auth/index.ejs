<%- include('../partials/header') %>
    <section class="hero">
        <form method="GET" action="/" class="searchbar">
            <select name="s" onchange="this.form.submit()">
      <option value="">-- All Suppliers --</option>
      <% suppliers.forEach(s => { %>
        <option value="<%= s._id %>" <%= supplierId && supplierId.toString() === s._id.toString() ? 'selected' : '' %>><%= s.name %></option>
      <% }) %>
    </select>
            <input type="text" name="q" value="<%= q %>" placeholder="Search products..." />
            <button type="submit">Search</button>
        </form>
    </section>

    <section class="grid">
        <% if (products.length === 0) { %>
            <p>No products found.</p>
            <% } %>
                <% products.forEach(p => { %>
                    <div class="card">
                        <h3>
                            <%= p.name %>
                        </h3>
                        <p>Price: <strong><%= p.price %></strong></p>
                        <p>Qty:
                            <%= p.quantity %>
                        </p>
                        <p>Supplier:
                            <%= p.supplier ? p.supplier.name : 'N/A' %>
                        </p>
                    </div>
                    <% }) %>
    </section>
    <%- include('../partials/footer') %>